[{^client_pid, client}] = :ets.lookup(__MODULE__, client_pid)

allowed_updates = %{
self_mute: message.self_mute,
self_deaf: message.self_deaf,
channel_id: message.channel_id
}



if message.session == client.session, do: :ets.insert(__MODULE__, {client_pid, new_client})




user_state = %{base_state| actor: client.session}
broadcast_message(client_pid, user_state)
send(client_pid, {:message, message})


Logger.debug("#{inspect message}")
